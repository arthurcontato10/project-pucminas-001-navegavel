<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Sistema de Rematrícula</title>
    <link rel="shortcut icon" href="./origem/imagens/pucMinasCanvasLogo.ico" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./origem/estilos/estilo--principal.css" />
    <link rel="stylesheet" href="./origem/estilos/estilo--responsivo.css" />
  </head>

  <body>
    <div class="repositorio--mensagens" id="repositorioMensagens"></div>
    <div class="pagina">
      <header class="barra--superior">
        <div class="marca--sistema">
          PUC Minas
          <span class="texto--suave">• Sistema de Rematrícula (Protótipo)</span>
        </div>
      </header>
      <main class="area--central">
        <section class="cartao--container cartao--estreito cartao--abas">
          <div class="container--abas">
            <button class="aba--unica aba--ativa" data-target="painelLogin">
              Entrar</button
            ><button class="aba--unica" data-target="painelRegistro">
              Registrar
            </button>
          </div>
          <div id="painelLogin" class="painel">
            <h2 class="titulo--principal">Entrar no sistema</h2>
            <form id="formularioLogin" class="formulario">
              <label for="usuario">Usuário (e-mail)</label>
              <div class="campo--com-icone">
                <i class="fas fa-envelope"></i
                ><input
                  id="usuario"
                  name="usuario"
                  type="email"
                  placeholder="Digite seu e-mail institucional"
                  required
                />
              </div>
              <label for="senha">Senha</label>
              <div class="campo--com-icone campo--senha">
                <i class="fas fa-lock"></i
                ><input
                  id="senha"
                  name="senha"
                  type="password"
                  placeholder="Digite sua senha"
                  required
                /><button type="button" class="alternar--senha">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <button type="submit" class="botao--principal">
                <i class="fas fa-sign-in-alt"></i> Entrar
              </button>
            </form>
            <div class="acesso--demonstracao">
              <button
                type="button"
                class="botao--principal botao--demonstracao"
                id="botaoLoginDemonstracao"
              >
                <i class="fas fa-rocket"></i> Acesso Rápido - Conta Demonstração
              </button>
            </div>
          </div>
          <div id="painelRegistro" class="painel" style="display: none">
            <h2 class="titulo--principal">Criar nova conta</h2>
            <form id="formularioRegistro" class="formulario">
              <label for="regNome">Nome Completo</label>
              <div class="campo--com-icone">
                <i class="fas fa-user"></i
                ><input
                  id="regNome"
                  type="text"
                  placeholder="Digite seu nome completo"
                  required
                />
              </div>
              <label for="regEmail">E-mail institucional</label>
              <div class="campo--com-icone">
                <i class="fas fa-envelope"></i
                ><input
                  id="regEmail"
                  type="email"
                  placeholder="Digite seu e-mail institucional"
                  required
                />
              </div>
              <label for="regSenha">Senha</label>
              <div class="campo--com-icone campo--senha">
                <i class="fas fa-lock"></i
                ><input
                  id="regSenha"
                  type="password"
                  placeholder="Digite uma nova senha"
                  required
                /><button type="button" class="alternar--senha">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <label for="regSenha2">Confirmar senha</label>
              <div class="campo--com-icone campo--senha">
                <i class="fas fa-lock"></i
                ><input
                  id="regSenha2"
                  type="password"
                  placeholder="Digite a mesma senha novamente"
                  required
                /><button type="button" class="alternar--senha">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
              <div class="checagem--termos">
                <label
                  ><input type="checkbox" id="checagemTermos" checked /><span
                    class="checagem--personalizada"
                    ><i class="fas fa-check"></i></span
                  ><span
                    >Ao se cadastrar, você concorda com os
                    <a href="./origem/paginas/termos--servicos.html"
                      >Termos de Serviço</a
                    >
                    e a
                    <a href="./origem/paginas/politica--privacidade.html"
                      >Política de Privacidade</a
                    >.</span
                  ></label
                >
              </div>
              <button type="submit" class="botao--principal" id="botaoRegistro">
                <i class="fas fa-user-plus"></i> Registrar
              </button>
            </form>
            <div class="ajuda texto--suave">
              <i class="fas fa-database"></i>Os usuários ficam salvos
              localmente.
            </div>
          </div>
        </section>
      </main>
      <footer class="rodape">
        <small
          >© 2025 Grupo 4 — Protótipo rematrícula navegável — PUC Minas.</small
        >
      </footer>
    </div>
    <script>
      function mostrarMensagem(e, t = "info") {
        const n = document.getElementById("repositorioMensagens"),
          c = document.createElement("div");
        let o = "fas fa-info-circle";
        t === "sucesso"
          ? (o = "fas fa-check-circle")
          : t === "erro"
          ? (o = "fas fa-times-circle")
          : t === "alerta"
          ? (o = "fas fa-exclamation-triangle")
          : (o = "fas fa-info-circle"),
          (c.className =
            t === "erro"
              ? "mensagem--item mensagem--erro"
              : t === "alerta"
              ? "mensagem--item mensagem--alerta"
              : "mensagem--item mensagem--sucesso"),
          (c.innerHTML = `<i class="${o}"></i><div class="conteudo--mensagem">${e}</div><button class="fechar--mensagem"><i class="fas fa-times"></i></button>`),
          n.appendChild(c);
        const i = c.querySelector(".fechar--mensagem"),
          a = () => {
            (c.style.animation = "mensagemSaida 0.4s ease forwards"),
              setTimeout(() => {
                n.contains(c) && n.removeChild(c);
              }, 400);
          };
        i.addEventListener("click", a), setTimeout(a, 5000);
      }
      function obterUsuarios() {
        try {
          return JSON.parse(
            localStorage.getItem("usuarios_rematricula") || "[]"
          );
        } catch (e) {
          return [];
        }
      }
      function definirUsuarios(e) {
        localStorage.setItem("usuarios_rematricula", JSON.stringify(e));
      }
      !(function () {
        const e = obterUsuarios(),
          t = e.some(
            (e) => e.email && e.email.toLowerCase() === "admin@pucminas.com"
          );
        t ||
          (e.push({
            name: "Administrador",
            email: "admin@pucminas.com",
            pass: "admin",
          }),
          definirUsuarios(e));
      })();
      if (localStorage.getItem("aba_ativa_registro") === "true") {
        setTimeout(() => {
          document.querySelector('[data-target="painelRegistro"]').click();
          localStorage.removeItem("aba_ativa_registro");
        }, 100);
      }
      document.querySelectorAll(".aba--unica").forEach((e) => {
        e.addEventListener("click", function () {
          document.querySelectorAll(".aba--unica").forEach((e) => {
            e.classList.remove("aba--ativa"), (e.style.transform = "scale(1)");
          }),
            this.classList.add("aba--ativa"),
            (this.style.transform = "scale(1.02)");
          const t = this.dataset.target;
          document.querySelectorAll(".painel").forEach((e) => {
            (e.style.display = e.id === t ? "block" : "none"),
              e.id === t && (e.style.animation = "fadeInUp 0.4s ease");
          });
        });
      }),
        document.querySelectorAll(".alternar--senha").forEach((e) => {
          e.addEventListener("click", function () {
            const t = this.closest(".campo--senha").querySelector("input"),
              e = this.querySelector("i");
            "password" === t.type
              ? ((t.type = "text"), (e.className = "fas fa-eye-slash"))
              : ((t.type = "password"), (e.className = "fas fa-eye"));
          });
        });
      const formularioLogin = document.getElementById("formularioLogin");
      formularioLogin.addEventListener("submit", (e) => {
        e.preventDefault();
        const t = document.getElementById("usuario").value.trim().toLowerCase(),
          n = document.getElementById("senha").value,
          c = obterUsuarios(),
          o = c.find((e) => e.email.toLowerCase() === t && e.pass === n);
        o
          ? (localStorage.setItem("usuario_logado", "true"),
            localStorage.setItem("nome_usuario", o.name || t),
            (window.location.href = "./origem/paginas/disciplinas.html"))
          : mostrarMensagem(
              "Usuário ou senha incorretos. Verifique e tente novamente.",
              "erro"
            );
      }),
        localStorage.getItem("usuario_logado") === "true" &&
          (window.location.href = "./origem/paginas/disciplinas.html");
      const formularioRegistro = document.getElementById("formularioRegistro"),
        botaoRegistro = document.getElementById("botaoRegistro"),
        checagemTermos = document.getElementById("checagemTermos"),
        botaoLoginDemonstracao = document.getElementById(
          "botaoLoginDemonstracao"
        );
      function alternarBotaoRegistro() {
        botaoRegistro.disabled = !checagemTermos.checked;
      }
      checagemTermos.addEventListener("change", function () {
        alternarBotaoRegistro(),
          this.checked ||
            mostrarMensagem(
              "Para sua segurança, precisamos que você aceite nossos Termos de Serviço e Política de Privacidade antes de continuar.",
              "alerta"
            );
      }),
        botaoLoginDemonstracao.addEventListener("click", () => {
          (document.getElementById("usuario").value = "admin@pucminas.com"),
            (document.getElementById("senha").value = "admin"),
            mostrarMensagem(
              "Conta de demonstração foi preenchida com sucesso!",
              "sucesso"
            );
        }),
        formularioRegistro.addEventListener("submit", (e) => {
          e.preventDefault();
          const t = document.getElementById("regNome").value.trim(),
            n = document.getElementById("regEmail").value.trim().toLowerCase(),
            c = document.getElementById("regSenha").value,
            o = document.getElementById("regSenha2").value;
          if (!t || !n || !c || !o)
            return mostrarMensagem("Preencha todos os campos.", "erro");
          if (c.length < 7)
            return mostrarMensagem(
              "Senha muito curta (mínimo 7 caracteres).",
              "erro"
            );
          if (c !== o)
            return mostrarMensagem("As senhas não coincidem.", "erro");
          if (!checagemTermos.checked)
            return mostrarMensagem(
              "Você deve aceitar os Termos de Serviço.",
              "erro"
            );
          const i = obterUsuarios();
          if (i.some((e) => e.email.toLowerCase() === n))
            return mostrarMensagem(
              "Já existe uma conta com esse e-mail.",
              "erro"
            );
          i.push({ name: t, email: n, pass: c }),
            definirUsuarios(i),
            mostrarMensagem(
              "Conta criada com sucesso. Você já pode entrar.",
              "sucesso"
            ),
            document.querySelector('[data-target="painelLogin"]').click(),
            (document.getElementById("usuario").value = n),
            (document.getElementById("senha").value = "");
        });
    </script>
  </body>
</html>
